#!/bin/bash
# kcmshell
#
# runs KDE's kcmshell4 program with a visual fake-progress meter
# which is good for gesture feedback when feedback by app is not working
# or possible... (try "kcmshell keys" to test it out)

if [ "$1" == "deskset" ]; then
	thename="Window Manager and Plasma Desktop Settings"
elif [ "$1" == "khotkey" ] || [ "$1" == "keys" ] || [ "$1" == "standard_actions" ]; then
	thename="Gestures and Shortcut Settings"
elif [ "$1" == "" ]; then
	thename="Nothing"
else
	last="$(eval echo \$$#)"
	for i in $*; do 
		if [ ! -z "$response" ]; then
			if [ "$i" == "$last" ]; then
				response+=" and "
			else		
				response+=", "
			fi
		fi
		response+=$i" ("$(kcmshell4 --list | grep ^$i | grep -Po "(?<=- ).*")")"
	done
	response+="."
	thename="$response"	
fi                         
for ((i=0;i<110;i+=10)); do echo $i; sleep 0.7; done | zenity --progress --auto-close --text "Starting $thename"
if [ "$1" == "deskset" ]; then
	deskset
else                                          
	kcmshell4 $*
	if [ $? -ne 0 ]; then
  	zenity --info --text "`kcmshell4 --list`"
	fi
fi
