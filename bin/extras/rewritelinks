#!/bin/bash
echo "warning: no sanity checks, make sure you are in the right directory and know what this command does"
echo "press a key to start or ctrl-c to stop"
read

mapfile LINES < rewrite-data
count=${#LINES[@]}
declare -i ERRCNT
declare -i ecnt
declare -i wcnt
for ((i=0;i<count;i++)); do

ERRCNT=0
cur=${LINES[i]}
SRC=`basename $(echo $cur | grep -Po ".*(?=:)")`; 	ERRCNT+=$?
DST=`basename $(echo $cur | grep -Po "(?<=:).*")`; 	ERRCNT+=$?
echo -ne "Removing $SRC..."
rm -f "$SRC"; 																			ERRCNT+=$?
echo -ne "Create Link $SRC -> $DST..."
ln -s "$DST" "$SRC";																ERRCNT+=$?
if [[ $ERRCNT -eq 0 ]]; then
	echo "[32;1mOkay[0m"
else
	case $ERRCNT in
	1)
	echo "[33;1m1 Warning[0m"; ((wcnt++))
	;;
	*)
	echo "[31;1m$ERRCNT Errors[0m"; ((ecnt++))
	;;
	esac
fi

done
echo "Finished, Processed $cnt entries, $ecnt of those had error(s), $wcnt warning(s)."

  
