#!/bin/bash

# locations, you can specify folder names that must exist
# or be more specific to include only specific locations
# separate entries with a pipe character! Keep between single
# quotes. Entries are NOT case sensitive!!!
# example 1: only from folders containing 'Downloads' or 'Videos' (default)
WHERE='Downloads|Videos'
# example 2: use a longer path to be more specific
# use the ^ anchor at the beginning to ensure absolute path prefixes!
# WHERE='^/usr/share/movies|^/usr/share/downloads'

# script to handle movie index

if [ -r /tmp/movieindex.txt ]; then
	EXISTS="Movie Index Exists Already"
else
	EXISTS="No Index, If you want to use playmovie, you must generate one!"
fi

choice "Update the movie index, it may take some time ($EXISTS)?"

if [ $? -eq 0 ]; then
	echo "Updating movie index, please wait!"
	locate --regex --ignore-case ".*($WHERE).*(avi|mpg|mp4|mpeg|asf|wmv|mkv|divx|mpe)$" > /tmp/movieindex.txt
	if [ -r /tmp/movieindex.txt ]; then
		echo "Creation Succeeded!"
		COUNT=$(grep -c ".*" /tmp/movieindex.txt)
		if [ $COUNT -gt 0 ]; then
			echo "$COUNT entities were added to the index!"
		else
			echo "WARNING: No items added to the index!!! playmovie will NOT work!"
		fi
	fi
else
	echo "Not updating the movie index."
	echo "$EXISTS"
fi

